<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="DAFormer: Improving network architectures and training strategies for domain-adaptive semantic segmentation" /><meta property="og:locale" content="en" /><meta name="description" content="Hoyer, Lukas, Dengxin Dai, and Luc Van Gool. “Daformer: Improving network architectures and training strategies for domain-adaptive semantic segmentation.” Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. 2022." /><meta property="og:description" content="Hoyer, Lukas, Dengxin Dai, and Luc Van Gool. “Daformer: Improving network architectures and training strategies for domain-adaptive semantic segmentation.” Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. 2022." /><link rel="canonical" href="https://eeaic.github.io/posts/DAFormer/" /><meta property="og:url" content="https://eeaic.github.io/posts/DAFormer/" /><meta property="og:site_name" content="EEAIC" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-01-09T14:32:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="DAFormer: Improving network architectures and training strategies for domain-adaptive semantic segmentation" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="dvawWW8ISEXZCcDUKr3P1LIHRmzi8MbiyMTRksiHk8E" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-01-15T18:36:14+09:00","datePublished":"2023-01-09T14:32:00+09:00","description":"Hoyer, Lukas, Dengxin Dai, and Luc Van Gool. “Daformer: Improving network architectures and training strategies for domain-adaptive semantic segmentation.” Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. 2022.","headline":"DAFormer: Improving network architectures and training strategies for domain-adaptive semantic segmentation","mainEntityOfPage":{"@type":"WebPage","@id":"https://eeaic.github.io/posts/DAFormer/"},"url":"https://eeaic.github.io/posts/DAFormer/"}</script><title>DAFormer: Improving network architectures and training strategies for domain-adaptive semantic segmentation | EEAIC</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="EEAIC"><meta name="application-name" content="EEAIC"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/commons/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">EEAIC</a></div><div class="site-subtitle font-italic">EE & AI Convergence</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/EEAIC" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['skjkee58','g.skku.edu'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>DAFormer: Improving network architectures and training strategies for domain-adaptive semantic segmentation</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4 pb-5"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>DAFormer: Improving network architectures and training strategies for domain-adaptive semantic segmentation</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1673242320" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jan 9, 2023 </em> </span> <span> Updated <em class="" data-ts="1673775374" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jan 15, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/EEAIC">Jeongkee Lim</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="4331 words"> <em>24 min</em> read</span></div></div></div><div class="post-content"><blockquote><p>Hoyer, Lukas, Dengxin Dai, and Luc Van Gool. “Daformer: Improving network architectures and training strategies for domain-adaptive semantic segmentation.” Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. 2022.</p></blockquote><h1 id="introduction">Introduction</h1><p>지난 수년간, 신경망은 많은 computer vision task에서 놀라운 성능을 달성해왔습니다. 하지만, 이러한 task에는 학습에 적합한 매우 많은 양의 data annotation이 필요합니다. Semantic segmentation의 경우, 모든 pixel에 대해 라벨을 붙여야하므로 특히 매우 많은 비용이 들어갑니다. 예를 들어, Cityscapes dataset의 이미지 한장을 annotation 하기 위해서는 1.5시간이 소요됩니다. 심지어, 악천후의 경우에는 3.3시간이 소요됩니다. 이러한 문제를 피하기 위한 방법 중 하나는 syntheic(가상으로 제작된) data를 사용하는 것입니다. 하지만, 일반적으로 사용되는 CNN은 domain shift에 매우 민감하고 synthetic data에서 실제 data로 잘 일반화되지 않습니다. 이러한 문제는 source data에서 학습된 신경망을 target label을 사용하지 않고 target data에 adaptation(적응)시키는 UDA(Unsupervised Domain Adaptation)방법을 통해 해결할 수 있습니다.</p><p>UDA 환경에서 평가된 여러 다양한 semantic segmentation architecture에 대한 연구를 기반으로, 저자들은 DAFormer를 제안합니다. 이것은 CNN보다 강력하다고 여겨지는 transformer를 기반으로 합니다. 저자들은 이를 context-aware multi-level fusion과 결합히여 UDA에서의 성능을 더욱 향상시켰습니다. 저자들이 주장하기로는 DAFormer는 UDA semantic segmentation 분야에서 transformer의 잠재력을 밝힌 첫번째 연구입니다.</p><p>더 복잡하고 강력한 architecture는 adaptation이 불안정하고 source domain에 과적합되기 쉽기 때문에, 저자들은 3가지 학습 기법을 제시하였습니다. 첫번째는 Rare Class Sampling(RCS)입니다. RCS는 흔한 class에 대해 self-training의 확증 편향 때문에 희귀 class에 대한 학습을 저해되는 문제를 해결하기 위해 source domain의 long-tail 분포를 고려하는 기법입니다. 희귀 class에 대한 이미지를 자주 샘플링하여, network가 pseudo-label의 quality를 향상시키고 확증 편향을 줄여 더 안정적으로 잘 학습할 수 있도록 합니다. 두번째로는 source domain에 대한 학습을 규제하기 위해 다양하고 표현력이 풍부한 ImageNet feature으로부터 지식을 distill(전달)하기 위한, Thing-Class ImageNet Feature Distance(FD)를 제안하였습니다. 여기서 ImageNet feature은 사물 class에 대하여 훈련되었기 때문에, 저자들은 FD를 사물class로 label이 지정된 이미지 영역으로 제한하였습니다. 세번째로, UDA를 위한 학습률 warmup을 새롭게 제안하였습니다. 학습 초기에 학습률을 의도한 값까지 선형적으로 증가시킴으로써, 학습 과정이 안정화되고 ImageNet feature가 시멘틱 세크멘테이션으로 더 잘 전달될 수 있다고 합니다.</p><h1 id="methods">Methods</h1><h2 id="self-trainingst-for-uda"><span class="mr-2">Self-training(ST) for UDA</span><a href="#self-trainingst-for-uda" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>먼저, 여러 network architecture를 평가하기 위한 baseline UDA에 대해 설명하겠습니다. UDA에서, network $g_\theta$는 target label $\mathcal Y_T$를 사용하지 않고 target 이미지 $\mathcal X_T=\lbrace x_T^{(i)}\rbrace_{i=1}^{N_T}$에 대해 좋은 성능을 달성하기 위해 source domain 이미지 $\mathcal X_S = \lbrace x_S^{(i)} \rbrace_{i=1}^{N_S}$와 one-hot label $\mathcal Y_S = \lbrace y_S^{(i)} \rbrace_{i=1}^{N_S}$를 사용하여 훈련됩니다. Source domain에 대해 categorical cross-entropy(CE) loss로 naive하게 훈련하면, 일반적으로 network가 target domain으로 잘 일반화되지 않기 때문에 target 이미지에 대해 성능이 떨어집니다.</p>\[\mathcal L_S^{(i)}=-\sum_{j=1}^{H \times W} \sum_{c=1}^C y_S^{(i,j,c)}\log g_\theta{(x_S^{(i)})^{(j,c)}}\]<p>이러한 domain간의 차이를 해결하기 위해 제안된 여러 방법은 adversarial training과 self-training으로 그룹화할 수 있습니다. 이 논문에서는 adversarial training이 덜 안정적이고 현재 ST 방법이 더 좋은 성능을 내는 것으로 알려있기 때문에 ST 방법을 활용합니다. Source에서 target domain으로 지식을 더 잘 전달하기 위해, ST는 target domain data에 대한 pseudo-label을 생성하기 위해 teacher network $h_\phi$를 사용합니다.</p>\[p^{(i,j,c)}_T=[c=\arg\max_{c^\prime}h_\phi(x^{(i)}_T)^{(j,c^\prime)}]\]<p>위 식에서 $[\sdot]$은 아이버슨 괄호<sup id="fnref:Iverson_bracket" role="doc-noteref"><a href="#fn:Iverson_bracket" class="footnote" rel="footnote">1</a></sup>를 나타냅니다. 여기서, teacher network는 gradient를 통한 backpropagation은 하지 않습니다. 또한, pseudo-label에 대한 quality/confidence estimate(추정치)를 생성합니다. 이를 계산하기 위해 maximum softmax probability 중 threshold $\tau$을 초과하는 pixel의 비율을 사용합니다.</p>\[q_T^{(i)}=\frac{\sum_{j=1}^{H \times W}[\max_{c^\prime}h_\phi{(x_T^{(i)})}^{(j,c^\prime)}\gt \tau]}{H \sdot W}\]<p>Pseudo-label과 quality estimate는 target domain에서 network $g_\theta$를 추가로 훈련하는데 사용됩니다.</p>\[\mathcal L_T^{(i)}=-\sum_{j=1}^{H \times W} \sum_{c=1}^C q_T^{(i)}p_T^{(i,j,c)}\log g_\theta{(x_T^{(i)})^{(j,c)}}\]<p>Pseudo-label은 online(훈련하는 과정에서) 혹은 offline(각각 따로 훈련하여)으로 생성할 수 있습니다. 여기서는 online ST를 선택했는데, 이는 하나의 훈련 단계만 있는 것이 덜 복잡한 설정이기 때문입니다. 이것은 우리가 다양한 network architecture를 비교하고 ablate할 때 중요합니다. Online ST에서 $h_\phi$는 $g_\theta$에 기반하여 업데이트됩니다. 일반적으로, $h_\phi$의 가중치는 각 training step 후 $g_\theta$의 exponentially moving average<sup id="fnref:Mean_teacher" role="doc-noteref"><a href="#fn:Mean_teacher" class="footnote" rel="footnote">2</a></sup>로 정해집니다.</p>\[\phi_{t+1} \leftarrow \alpha\phi_t + (1-\alpha)\theta_t\]<p>Semi-supervised learning과 UDA에서 ST는 teacher network $h_\phi$가 non-augmented target data을 사용하여 생성하는 동안, student network $g_\theta$가 augmented target data에 대해 훈련하는 것이 특히 효율적인 것으로 알려져 있습니다. 이 연구에서는, 기본적으로 DACS<sup id="fnref:DACS" role="doc-noteref"><a href="#fn:DACS" class="footnote" rel="footnote">3</a></sup> 방법을 따르고 더 많은 domain-robust feature를 학습시키기 위한 data augmentation으로 color jitter, Gaussian blur와 ClassMix를 사용합니다.</p><h2 id="daformer-network-architecture"><span class="mr-2">DAFormer Network Architecture</span><a href="#daformer-network-architecture" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>이 연구 이전에는 대부분 오래된 DeepLabV2 architecture를 사용하여 그들의 연구를 평가했습니다. 이러한 이유로, 저자들은 좋은 supervised 성능뿐만아니라 좋은 DA 능력을 가진 network를 설계하였습니다.</p><p>인코더의 경우, 강력하면서도 robust한 network architecture를 목표로 합니다. Robustness는 domain-invariant feature에 대한 학습을 의미하기 때문에 좋은 DA 성능을 달성하기 위한 중요한 특성입니다. 최근 연구 결과에 따르면, transformer는 이러한 특성을 만족하기 때문에 UDA에 적합합니다. Transformer의 self-attention과 CNN 둘 다 weighted sum을 수행하지만, 그들의 weight는 서로 다르게 계산됩니다. CNN에서의 weight는 훈련 중에 학습되고 테스트 중에는 고정됩니다. 반면에, self-attention mechanism은 모든 token 쌍간의 similarity(유사성) 혹은 affinity(관련성)를 기반으로 동적으로 weight를 계산합니다. 결과적으로, self-attention mechanism은 CNN보다 더 adaptive한 일반적인 모델링 수단을 제공합니다.</p><p>이 논문에서는 기본적으로 semantic segmentation을 위해 설계된 Mix Transformer(MiT)<sup id="fnref:MiT" role="doc-noteref"><a href="#fn:MiT" class="footnote" rel="footnote">4</a></sup>를 따릅니다. 이미지는 semantic segmentation을 위한 detail을 보존하기 위해 $4 \times 4$(ViT<sup id="fnref:ViT" role="doc-noteref"><a href="#fn:ViT" class="footnote" rel="footnote">5</a></sup>에서는 $16 \times 16$ 크기였던 것 대신에) 크기의 작은 patch로 나누어집니다. 고해상도 feature에 대응하기 위해, self-attention block에서는 sequence reduction<sup id="fnref:Sequence_reduction" role="doc-noteref"><a href="#fn:Sequence_reduction" class="footnote" rel="footnote">6</a></sup>이 사용됩니다. Transformer 인코더는 여러 단계의 feature map $F_i \in \mathbb{R}^{\frac{H}{2^{i+1}}\times\frac{W}{2^{i+1}}\times C_i}$을 생성하도록 설계되었습니다. Feature map의 downsampling은 local continuity를 보전하기 위해 overlapped patch merging<sup id="fnref:MiT:1" role="doc-noteref"><a href="#fn:MiT" class="footnote" rel="footnote">4</a></sup>을 통해 구현되었습니다.</p><p>Semantic segmentation에 대한 이전 연구들은 일반적으로 디코더에서는 local 정보들만 사용합니다. 이와 대조적으로, 저자들은 디코더에서 추가적인 context 정보를 활용하는 것을 제안했습니다. 왜냐하면, 이는 UDA에 도움이 되는 특성인 semantic segmentation의 robustness를 중가시켜주기 때문입니다. Bottleneck feature의 context 정보만을 고려하는 것 대신에, DAFormer는 서로 다른 단계의 인코더의 feature를 통해 context 정보를 고려합니다. 이전의 고해상도에서의 추출된 추가적인 feature가 semantic segmentation을 위한 중요한 하위 단계의 개념을 제공하기 때문입니다. DAFormer 디코더의 구조는 아래 그림에서 확인할 수 있습니다.</p><p><img data-src="/assets/img/posts/2023-01-09-DAFormer/DAFormer.png" alt="Figure 1" data-proofer-ignore> <em>Figure 1: Rare Class Sampling, Thing-Class Feature Distance 그리고 DAFormer로 구성된 UDA framework 개요</em></p><p>Feature fusion을 하기 전에, $1 \times 1$ convolution을 통해 각 $F_i$를 같은 수의 채널 $C_e$로 임베딩하고 $F_1$의 크기로 feature를 upsampling 한 뒤 이를 concatenation 하였습니다. Context-aware feature fusion의 경우, ASPP<sup id="fnref:ASPP" role="doc-noteref"><a href="#fn:ASPP" class="footnote" rel="footnote">7</a></sup>와 유사하지만 global average pooling 없이 서로 다른 dilation rate를 가지는 multiple parallel $3 \times 3$ depthwise separable convolution과 $1 \times 1$ convolution을 사용합니다. ASPP와는 달리, 이를 bottleneck feature $F_4$에만 적용하지 않고 모든 stacked multi-level feature를 융합하는데 적용하였습니다. Depthwise separable convolution은 일반적인 convolution보다 더 적은 수의 parameter를 가지고 있어 source domain에 대해 과적합을 줄일 수 있다는 장점이 있습니다.</p><h2 id="training-strategies-for-uda"><span class="mr-2">Training Strategies for UDA</span><a href="#training-strategies-for-uda" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="rare-class-samplingrcs"><span class="mr-2">Rare Class Sampling(RCS)</span><a href="#rare-class-samplingrcs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>저자들은 source dataset에서 희귀 class에 대한 UDA 성능이 여러 실험에서 유의미하게 다르다는 것을 관찰했습니다. Data 샘플링 순서가 랜덤 시드에 의존하기 때문에, 이러한 class가 훈련 중 서로 다른 시점에서 학습되거나 혹은 학습되지 않을 수 있습니다. 특정 class가 훈련 중에 늦게 배울수록, 훈련이 끝날 때 그것에 대한 성능은 더 나빠집니다. 이러한 이유로 저자들은 희귀 class가 포함된 관련 샘플이 무작위성으로 인해 훈련 후반에만 나타나는 경우 network는 나중에 학습을 시작하게 되고, 이는 network가 이미 자주 등장하는 class에 대한 강한 편향을 학습하여 매우 적은 샘플로 새로운 개념(class)을 ‘재학습’하기 어려울 것이라고 생각했습니다. 이러한 점은 ST의 teacher network의 확증 편향에 따라 더욱 강화됩니다.</p><p>이 문제를 해결하기 위해 저자들은 Rare Class Sampling(RCS)를 제안합니다. 이 방법은 희귀 class를 더 일찍 그리고 잘 학습하기 위해 source domain에서 더 자주 샘플링하는 방법입니다. Source dataset에서 각 class $c$의 빈도 $f_c$는 각 class $c$에 대한 pixel의 개수에 기반하여 계산할 수 있습니다.</p>\[f_c=\frac{\sum^{N_S}_{i=1}\sum^{H \times W}_{j=1}[y_S^{(i,j,c)}]}{N_S \sdot H \sdot W}\]<p>어떤 class $c$에 대한 샘플링 확률 $P(c)$은 그것의 빈도 $f_c$에 대한 식으로 정의됩니다.</p>\[P(c)=\frac{e^{(1-f_c)/T}}{\sum^C_{c^\prime = 1}e^{(1-f_{c^\prime})/T}}\]<p>그러므로, 더 작은 빈도를 가지는 class는 더 높은 샘플링 확률을 가지게 됩니다. Temperture $T$는 분포의 smoothness를 제어합니다. $T$가 높을수록 uniform(균일) 분포에 가깝고, $T$가 낮을수록 작은 $f_c$을 가지는 희귀 class에 집중합니다. 각 source 샘플의 경우, 확률 분포 $c \sim P$으로부터 class를 샘플링하고 이러한 class를 포함하는 data의 부분집합에 대한 균일 분포 $x_S \sim \mathrm{uniform}(\mathcal X_{S,c})$으로부터 이미지를 샘플링합니다. 이 방식은 희귀 class를 포함하는 이미지를 오버샘플링할 수 있습니다. 희귀 class(작은 $f_c$)는 일반적으로 단일 이미지에서 여러 흔한 class(큰 $f_c$)와 함께 발생하므로, re-sampling된 class간의 균형을 맞추기 위해서는 흔한 class보다 희귀 class를 더 자주($P(c_{rare}) \gt P(c_{common})$) 샘플링하는 것이 좋습니다. 예를 들어, 흔한 class인 도로는 버스, 기차 또는 오토바이와 같은 희귀 class와 같이 나타나므로 이미 이러한 희귀 class로 샘플링할 때 이미 같이 다뤄지게 됩니다. Temperature $T$는 작은 $f_c$와 중간 $f_c$에 대해서 re-sampling된 class의 pixel의 수가 균형이 맞도록 선택됩니다.</p><h3 id="thing-class-imagenet-feature-distancefd"><span class="mr-2">Thing-Class ImageNet Feature Distance(FD)</span><a href="#thing-class-imagenet-feature-distancefd" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>일반적으로, semantic segmentation 모델 $g_\theta$는 의미있는 일반적인 feature로부터 학습을 시작하기 위해 ImageNet 분류를 위해 pretrain된 weight로 초기화합니다. ImageNet에는 UDA에서 종종 구별하기 어려운 기차나 버스 같이 high-level semantic class에 대한 일부 실제 이미지도 포함되어 있다는 점을 고려하면, 저자들은 ImageNet feature가 일반적인 pretrain의 이점을 넘어 유용한 가이드를 제공할 수 있다고 생각했습니다. 특히, DAFormer는 훈련의 시작에는 몇몇 구별하기 어려운 class를 잘 구분하지만 훈련이 진행되면서 나중에는 해당 class를 잘 구분하지 못하는 문제를 관찰했습니다. 따라서, pretrain을 통한 ImageNet의 유용한 feature가 $L_S$에 의해 손상되고 모델이 synthetic source data에 과적합되었다고 볼 수 있습니다.</p><p>이러한 문제를 막기 위해, semantic segmentation UDA 모델 $g_{\theta}$의 bottleneck feature $F_\theta$와 ImageNet 모델의 bottleneck feature $F_{ImageNet}$간의 Feature Distance(FD)에 기반하여 모델을 규제합니다.</p>\[d(i,j) = \Vert F_{ImageNet}(x^{(i)}_S)^{(j)}-F_\theta(x^{(i)}_S)^{(j)}\Vert_2\]<p>그러나, ImageNet 모델은 주로 사물 class(자동차나 얼룩말처럼 윤곽이 뚜렷한 물체)에 대해 학습됩니다. 그러므로, FD loss는 이진 마스크 $M_{things}$를 통해 사물 class $C_{things}$가 포함된 이미지 영역에 대해서만 계산되어야 합니다.</p>\[\mathcal{L}^{(i)}_{FD}=\frac{\sum^{H_F \times W_F}_{j=1}d^{(i, j)}\sdot M^{(i, j)}_{things}}{\sum_jM^{(i, j)}_{things}}\]<p>여기서 마스크는 downscaled label $y_{S,small}$로부터 얻어집니다.</p>\[M^{(i, j)}_{things}=\sum^C_{c^\prime=1} y^{i,j,c^\prime}_{S, small}\sdot [c^\prime \in \mathcal{C}_{things}]\]<p>Label을 bottleneck feature 크기로 다운샘플링하기 위해서, $\frac{H}{H_F} \times \frac{W}{W_F}$크기의 patch를 통해 average pooling을 class 채널에 적용하고 class는 일정 비율 $r$을 초과할 때 유지됩니다.</p>\[y^c_{S,small}=[\mathrm{AvgPool}(y^c_S,H/H_F,W/W_F)\gt r]\]<p>이것은 이미지에서 주된 사물 class에 대한 bottleneck feature pixel만 feature distance에 고려되도록 합니다.</p><p>전체적인 UDA loss $\mathcal{L}$ 은 제시된 loss 요소들의 weighted sum입니다.</p>\[\mathcal L= \mathcal L_S + \mathcal L_T + \lambda_{FD} \mathcal L_{FD}\]<h3 id="learning-rate-warmup-for-uda"><span class="mr-2">Learning Rate Warmup for UDA</span><a href="#learning-rate-warmup-for-uda" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>훈련 시작시 선형적으로 학습률을 warmup하는 것은 CNN과 transformer 둘 다에서 성공적으로 사용되어져 왔습니다. 왜냐하면, 훈련 시작시 adaptive 학습률의 큰 분산은 gradient 분포를 왜곡하는 것을 방지하여 network의 일반화능력을 향상시키기 때문입니다.<sup id="fnref:Adaptive_lr" role="doc-noteref"><a href="#fn:Adaptive_lr" class="footnote" rel="footnote">8</a></sup> 저자들은 이러한 학습률 warmup을 UDA에 새롭게 도입하였습니다. 저자들은 ImageNet에 대해 pretrain된 feature를 왜곡하는 것은 실제 domain에 대한 유용한 가이드를 잃는 것이기 때문에 UDA에 특히 중요함을 상정합니다. Iteration $t_{warm}$까지의 warmup 기간 동안, iteration $t$에서의 학습속도는 $\eta_t =\eta_{base} \sdot t/t_{warm}$으로 설정됩니다.</p><h1 id="conclusion">Conclusion</h1><p>이 논문은 transformer encoder와 context-aware fusion decoder를 기반으로 하여 UDA에 적합한 architecture를 제안했습니다. 이 architecture는 UDA에 대하여 transformer의 가능성을 보여줬습니다. 추가적으로 학습의 안정화와 규제를 위한, 더욱이 DAFormer의 성능을 향상시키는 3가지의 학습 기법을 제안했습니다. 전체적으로, DAFormer는 UDA에서 큰 성능 향상을 보여줬습니다. 여기서 제시된 DAFormer는 이후의 논문인 HRDA, MIC에서도 사용되는 만큼 향후 연구를 이해하는데 필수적인 논문이라 생각됩니다.</p><h1 id="footnote">Footnote</h1><div class="footnotes" role="doc-endnotes"><ol><li id="fn:Iverson_bracket" role="doc-endnote"><p>Wikipedia contributors. (2022, October 24). Iverson bracket. Wikipedia. <a href="https://en.wikipedia.org/wiki/Iverson_bracket">https://en.wikipedia.org/wiki/Iverson_bracket</a> <a href="#fnref:Iverson_bracket" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:Mean_teacher" role="doc-endnote"><p>Antti Tarvainen and Harri Valpola. Mean teachers are better role models: Weight-averaged consistency targets improve semi-supervised deep learning results. In Adv. Neural Inform. Process. Syst., pages 1195–1204, 2017. <a href="#fnref:Mean_teacher" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:DACS" role="doc-endnote"><p>Wilhelm Tranheden, Viktor Olsson, Juliano Pinto, and Lennart Svensson. DACS: Domain Adaptation via Crossdomain Mixed Sampling. In IEEE Winter Conf. on Applications of Comput. Vis., pages 1379–1389, 2021. <a href="#fnref:DACS" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:MiT" role="doc-endnote"><p>Enze Xie, Wenhai Wang, Zhiding Yu, Anima Anandkumar, Jose M. Alvarez, and Ping Luo. SegFormer: Simple and Efficient Design for Semantic Segmentation with Transformers. In Adv. Neural Inform. Process. Syst., 2021. <a href="#fnref:MiT" class="reversefootnote" role="doc-backlink">&#8617;</a> <a href="#fnref:MiT:1" class="reversefootnote" role="doc-backlink">&#8617;<sup>2</sup></a></p><li id="fn:ViT" role="doc-endnote"><p>Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn, Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg Heigold, Sylvain Gelly, et al. An image is worth 16x16 words: Transformers for image recognition at scale. In Int. Conf. Learn. Represent., 2020. <a href="#fnref:ViT" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:Sequence_reduction" role="doc-endnote"><p>Wenhai Wang, Enze Xie, Xiang Li, Deng-Ping Fan, Kaitao Song, Ding Liang, Tong Lu, Ping Luo, and Ling Shao. Pyramid vision transformer: A versatile backbone for dense prediction without convolutions. In Int. Conf. Comput. Vis., pages 568–578, 2021. <a href="#fnref:Sequence_reduction" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:ASPP" role="doc-endnote"><p>Liang-Chieh Chen, Yukun Zhu, George Papandreou, Florian Schroff, and Hartwig Adam. Encoder-decoder with atrous separable convolution for semantic image segmentation. In Eur. Conf. Comput. Vis., pages 801–818, 2018. <a href="#fnref:ASPP" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:Adaptive_lr" role="doc-endnote"><p>Liyuan Liu, Haoming Jiang, Pengcheng He, Weizhu Chen, Xiaodong Liu, Jianfeng Gao, and Jiawei Han. On the variance of the adaptive learning rate and beyond. In Int. Conf. Learn. Represent., 2019. <a href="#fnref:Adaptive_lr" class="reversefootnote" role="doc-backlink">&#8617;</a></p></ol></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/paper-review/'>Paper Review</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/paper-review/" class="post-tag no-text-decoration" >paper review</a> <a href="/tags/cvpr/" class="post-tag no-text-decoration" >CVPR</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=DAFormer%3A+Improving+network+architectures+and+training+strategies+for+domain-adaptive+semantic+segmentation+-+EEAIC&url=https%3A%2F%2Feeaic.github.io%2Fposts%2FDAFormer%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=DAFormer%3A+Improving+network+architectures+and+training+strategies+for+domain-adaptive+semantic+segmentation+-+EEAIC&u=https%3A%2F%2Feeaic.github.io%2Fposts%2FDAFormer%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Feeaic.github.io%2Fposts%2FDAFormer%2F&text=DAFormer%3A+Improving+network+architectures+and+training+strategies+for+domain-adaptive+semantic+segmentation+-+EEAIC" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Symbolic-link-in-Linux/">Symbolic link in Linux</a><li><a href="/posts/Windows-filename/">[Troubleshooting] A file name cannot contain any of the following characters</a><li><a href="/posts/DAFormer/">DAFormer: Improving network architectures and training strategies for domain-adaptive semantic segmentation</a><li><a href="/posts/Linear-discriminants-analysis/">Linear discriminant anlaysis</a><li><a href="/posts/Install-MATLAB-on-Linux/">Install MATLAB on Linux</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/paper-review/">paper review</a> <a class="post-tag" href="/tags/dimensionality-reduction/">Dimensionality reduction</a> <a class="post-tag" href="/tags/troubleshooting/">troubleshooting</a> <a class="post-tag" href="/tags/command/">command</a> <a class="post-tag" href="/tags/cvpr/">CVPR</a> <a class="post-tag" href="/tags/eccv/">ECCV</a> <a class="post-tag" href="/tags/installation/">installation</a> <a class="post-tag" href="/tags/lda/">LDA</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/matlab/">matlab</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/How-to-Read-a-Paper/"><div class="card-body"> <em class="small" data-ts="1663130400" data-df="ll" > Sep 14, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>How to Read a Paper</h3><div class="text-muted small"><p> Keshav, Srinivasan. “How to read a paper.” ACM SIGCOMM Computer Communication Review  37.3 (2007): 83-84. 대학원 생활을 하면서 여러 논문을 읽을 기회가 생겼습니다. 문제는 논문 하나를 읽는데에 걸리는 시간이 너무나 길었습니다. 어떻게 하면 논문을 효율적으로 읽...</p></div></div></a></div><div class="card"> <a href="/posts/HRDA/"><div class="card-body"> <em class="small" data-ts="1673581980" data-df="ll" > Jan 13, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HRDA: Context-Aware High-Resolution Domain-Adaptive Semantic Segmentation</h3><div class="text-muted small"><p> Hoyer, L., Dai, D., &amp;amp; Van Gool, L. (2022). HRDA: Context-Aware High-Resolution Domain-Adaptive Semantic Segmentation. Proceedings of the European Conference on Computer Vision (ECCV). Intr...</p></div></div></a></div><div class="card"> <a href="/posts/Windows-filename/"><div class="card-body"> <em class="small" data-ts="1674632700" data-df="ll" > Jan 25, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Troubleshooting] A file name cannot contain any of the following characters</h3><div class="text-muted small"><p> Windows에서 파일을 일부 문자를 포함해서 저장하려고 시도하면 아래와 같은 이유로 저장할 수 없습니다. Figure 1: 파일 이름 입력시 사용할 수 없는 문자를 입력하면 뜨는 경고창 Troubleshooting \ / : * ? &quot; &amp;lt; &amp;gt; |를 사용하는 것은 불가능하므로 이와 유사한 문자를 찾아 사용해야 합니다. 여기서는 두가지...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Sequential-feature-selection/" class="btn btn-outline-primary" prompt="Older"><p>Sequential feature selection</p></a> <a href="/posts/HRDA/" class="btn btn-outline-primary" prompt="Newer"><p>HRDA: Context-Aware High-Resolution Domain-Adaptive Semantic Segmentation</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "EEAIC/eeaic.github.io", "data-repo-id": "R_kgDOH-ullQ", "data-category": "Announcements", "data-category-id": "DIC_kwDOH-ullc4CRYdP", "data-mapping": "pathname", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "bottom", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/EEAIC">Jeongkee Lim</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/paper-review/">paper review</a> <a class="post-tag" href="/tags/dimensionality-reduction/">Dimensionality reduction</a> <a class="post-tag" href="/tags/troubleshooting/">troubleshooting</a> <a class="post-tag" href="/tags/command/">command</a> <a class="post-tag" href="/tags/cvpr/">CVPR</a> <a class="post-tag" href="/tags/eccv/">ECCV</a> <a class="post-tag" href="/tags/installation/">installation</a> <a class="post-tag" href="/tags/lda/">LDA</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/matlab/">matlab</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.js"></script> <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script> <script> document.addEventListener("DOMContentLoaded", function() { renderMathInElement(document.body, { delimiters: [ {left: '$$', right: '$$', display: true}, {left: '$', right: '$', display: false}, {left: '\\(', right: '\\)', display: true}, {left: '\\[', right: '\\]', display: false} ], throwOnError : false }); }); </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=4057717145"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', '4057717145'); }); </script>
